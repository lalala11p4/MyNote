#### 十四.Linux进程管理

##### 1.查看进程

​	指令：

​				ps     （显示系统执行的进程）一般来说的参数是  ps  -aux

​	![1564675506484](E:\Typora笔记\Pic\1564675506484.png)

​		USER:	用户名

​		PID	：进程ID

​		%CPU	:占用CPU情况

​		%MEM	：占用内存情况

​		VSZ	:使用的虚拟内存

​		RSS	:使用的物理内存情况

​		TTY	：使用的终端

​		STAT	:进程的状态，s:休眠   r：运行

​		START	:启动时间

​		TIME	：占用CPU总时间

​		COMMAND	:进程执行时的命令行

​	例：查看进程中sshd信息

​						ps  -aux   |   grep  sshd    

![1564675981389](E:\Typora笔记\Pic\1564675981389.png)

​	例：已全格式显示当前所有进程，查看进程的父进程

​						ps  -ef   |  more 

​	![1564676212749](E:\Typora笔记\Pic\1564676212749.png)

##### 2.终止进程

​	指令：   kill  [选项]     进程号      （通过进程号杀死进程）

​				  killall        进程名称         (通过进程名杀死进程，支持通配符)

​						-9	：表示强迫进程立即停止

​	例1：踢掉某个非法登录用户

![1564837078831](E:\Typora笔记\Pic\1564837078831.png)

​	![1564837122010](E:\Typora笔记\Pic\1564837122010.png)

​	例2：终止远程登录服务sshd    在适当的时候再次重启sshd服务

![1564837771049](E:\Typora笔记\Pic\1564837771049.png)

​	例3：终止多个gedit编辑器[kill  all   通过进程名称来终止进程]

​	![1564838070312](E:\Typora笔记\Pic\1564838070312.png)

​	例4：强制杀掉一个终端

![1564838316649](E:\Typora笔记\Pic\1564838316649.png)

##### 3.查看进程树

​	pstree  [选项]

​				-p  显示进程的PID

​				-u  显示进程的所属用户

例：以树状结构显示进程的pid

![1564838603209](E:\Typora笔记\Pic\1564838603209.png)

例：以树状结构显示进程的用户id	

![1564838644456](E:\Typora笔记\Pic\1564838644456.png)

##### 4.服务管理

​	服务（service）本质就是进程，但是是在后台运行的，通常会监听某个端口，等待其他程序的请求，比如（mysql，sshd，防火墙），因此我们也叫做守护进程，是linux中重要的知识点。

![1564840229813](E:\Typora笔记\Pic\1564840229813.png)

​	service  管理命令

​		service  服务名    [start   |  stop  |  reload  |   status ]

​		在CentOS7.0之后不再使用service而是systemctl

​	使用案例：

​		例：查看当前防火墙状态，关闭和重启防火墙

​				查看

![1564840538938](E:\Typora笔记\Pic\1564840538938.png)

​			停止防火墙，启动防火墙

![1564840619261](E:\Typora笔记\Pic\1564840619261.png)

​		

**这种方式只是临时生效，当重启系统时，还是回归到以前对服务的设置**

**如果希望设置某个服务自启动或者关闭永久生效，要使用chkconfig指令**



查看服务名：

​	方法一：

​		使用setup  -->系统服务  就可以看到

![1564841149159](E:\Typora笔记\Pic\1564841149159.png)

​	方式二;

​		/etc/init.d/服务名称

​			![1564841234303](E:\Typora笔记\Pic\1564841234303.png)

​											**默认级别重点（6个级别）熟练背下来**

服务管理指令：

​	chkconfig:

​			通过chkconfig命令可以给每个服务的各个运行级别设置自启动/关闭

​	基本语法：

​			1）查看服务名   chlconfig   -list  |  grep   xxx

![1564841918518](E:\Typora笔记\Pic\1564841918518.png)

![1564841964459](E:\Typora笔记\Pic\1564841964459.png)

​			2）chkconfig   服务名  -list

![1564842017378](E:\Typora笔记\Pic\1564842017378.png)

​			3）chkconfig   -level   5  服务名   on/off

![1564842128131](E:\Typora笔记\Pic\1564842128131.png)



​		例1：显示当前系统所有服务的各个运行级别的运行状态

​			chkconfig  --list

​		例2：请查看sshd服务的运行状态

​			service  sshd status

​		例3：将sshd服务在运行级别5下设置为不自动启动，观察效果

​			chkconfig --level  5  sshd off

​		例4：在运行级别为5时关闭防火墙

​			chkconfig --level 5 iptables off

​		例5：在所有运行级别下关闭防火墙

​			chkconfig iptables off

​		例6：在所有运行级别下开启防火墙

​			chkconfig iptables on

​								

​								**chkconfig修改之后需要重启服务才能生效**



##### 5.动态监控过程

​	top和ps命令很相似，他们都用于显示正在执行的进程，top和ps最大的不同之处在于top在执行一段时间可以跟新正在进行的进程

​	top  [选项]

​			-d	指定top命令每隔几秒更新 默认是3秒

​			-i	使top不显示任何闲置或者僵死进程

​			-p	指定监控进程id来仅仅监控某个进程的状态

（q退出）

​	例：监视特定用户



![1564843658682](E:\Typora笔记\Pic\1564843658682.png)

​				**输入u   在输入用户名即可**

​	例：终止指定的程序

​							**输入K   然后输入想要删除的进程PID**![1564843824696](E:\Typora笔记\Pic\1564843824696.png)

​	例：指定系统状态更新的时间（每隔10秒自动更新）

​				top  -d  10

​			（排序输入想要的项的大写首字母）

##### 6.监控网络状态

​	netstat  [选项]

​	netstat -anp

​			-an	按一定顺序排列输出	

​			-p	  显示哪个进程在调用

​	应用案例：

​			查看所有的服务信息

![1564845902319](E:\Typora笔记\Pic\1564845902319.png)

​			查看服务名为sshd的服务信息

![1564845950278](E:\Typora笔记\Pic\1564845950278.png)

