#### 十七.Shell编程

​	对于大数据程序员，用于管理集群,或者定时进行备份数据库

​	shell  是一个命令行解释器，为用户向linux发送请求以便运行程序的界面系统级程序

	##### 1.shell脚本执行方式

​	脚本以  #!/bin/bash  开头

​			例：编写第一个shell脚本  输出  hello world！

​			![1565234828337](E:\Typora笔记\Pic\1565234828337.png)

​	shell脚本的执行方式

​		1）输入脚本的绝对路径或者相对路径

​				首先赋予myShell.sh脚本的+x权限

​				执行脚本

![1565235772577](E:\Typora笔记\Pic\1565235772577.png)

​		2）sh+脚本

​				不给脚本+x权限，直接执行

​				![1565235987609](E:\Typora笔记\Pic\1565235987609.png)

##### 2.shell变量

​	Linux  Shell 中的变量 :  系统变量，用户自定义变量

​		系统变量：$HOME   $PWD

​		显示当前shell中所有变量：set

![1565243951867](E:\Typora笔记\Pic\1565243951867.png)

![1565243973170](E:\Typora笔记\Pic\1565243973170.png)

​		

​			自定义变量：

​				定义变量：变量=值

​				撤销变量：unset  变量

​				声明静态变量：  readonly  变量   注意：不能  unset

​			案例：定义变量A

​			案例：撤销变量A

![1565244814705](E:\Typora笔记\Pic\1565244814705.png)

![1565244844313](E:\Typora笔记\Pic\1565244844313.png)

​			案例：声明静态变量B=2，不能unset

![1565244953218](E:\Typora笔记\Pic\1565244953218.png)

​			案例：把变量提升为全局环境变量，可供其他shell程序使用



​			变量名称可以由字母数字下划线组成，但是不能以数字开头

​			等号两侧不能有空格

​			变量名称一般习惯为大写

##### 3.将命令的返回值付给变量（重点）

​		反引号赋值

![1565271601015](E:\Typora笔记\Pic\1565271601015.png)

​		$（）赋值

![1565271844486](E:\Typora笔记\Pic\1565271844486.png)

##### 4.shell设置环境变量

​	基本语法

​		export 变量名 = 变量值（功能描述：将shell变量输出为环境变量）

​		source 配置文件  （功能描述：让修改后的配置信息立即生效）

​		echo  $变量名   （功能描述：查询环境变量的值）

​	快速入门

​		1）在/etc/profile 文件中定义TOMCAT_HOME的环境变量

​		2）查看环境变量TOMCAT_HOME的值

​		3）在另外一个shell程序中使用TOMCAT_HOME

​		**注意：在输出JAVA_HOME环境变量之前，需要让其生效，source /etc/profile**

​		![1565272672687](E:\Typora笔记\Pic\1565272672687.png)

![1565272719518](E:\Typora笔记\Pic\1565272719518.png)

##### 5.位置参数变量

​	当执行shell脚本时，希望获取到命令行参数信息，可以使用位置参数变量，例如：/myshell.sh 100 200, 类似于传递参数进去

​	基本语法：

​		$n:n为数字，$0代表命令本身，$1-$9代表第一到第九个参数，十以上的参数${10}

​		$* :代表命令行中所有的参数，$* 把所有参数看作一个整体

​		$@:代表命令行中的所有参数，不过$ * 把每个参数区分对待

​		$#:代表命令号中所有参数的个数

​	案例：

​		编写一个shell脚本positionPara.sh   从脚本中获取命令行的各个参数信息

​	![1565273931983](E:\Typora笔记\Pic\1565273931983.png)

![1565273946703](E:\Typora笔记\Pic\1565273946703.png)

##### 6.预定义变量

​	shell设计者实现定义好的变量，可以直接使用

​	基本语法

​		$$:当前进程的PID号

​		$!:后台运行的最后一个进程的进程号PID

​		$?:最后一次执行命令的返回状态，如果变量的值为0，证明上一个命令正确执行，非0的话证明上一个命令执行不正确

​	应用实例

​		使用预定义变量

​		![1565274632792](E:\Typora笔记\Pic\1565274632792.png)

![1565274648617](E:\Typora笔记\Pic\1565274648617.png)

##### 7.shell运算符

​	基本语法

​		"$((运算式))"    或者    "$[运算式]"

​		expr  m  +   n

​		**注意expr运算符之间要有空格**

​		expr  m  -   n

​		expr  \ *            /           %        乘除取余

​	案例1：计算（2+3）x 4 的值

![1565275572415](E:\Typora笔记\Pic\1565275572415.png)

![1565275590439](E:\Typora笔记\Pic\1565275590439.png)

​	案例2：请求出命令行的两个参数[整数]的和

![1565276250232](E:\Typora笔记\Pic\1565276250232.png)

![1565276262871](E:\Typora笔记\Pic\1565276262871.png)

##### 8.shell编程if条件语句判断

​	基本语法

​		[ condition ]  **注意condition前后要有空格**

​		非空返回true   可食用$?  验证（0为true，>1 为false）

​	应用实例

​		[ atguigu ]  返回true

​		[  ]   返回false

​		[ condition ]  &&  echo OK  ||  ech   notok      条件满足  执行后面的语句

​	常用的判断条件

​		= 字符串比较

​		lt 小于

​		le小于等于

​		eq等于

​		gt大于

​		ge大于等于

​		ne不等于

​		-r有读的权限

​		-w有写的权限

​		-x有执行的权限

​		-f文件存在并且是一个常规的文件

​		-e文件存在

​		-d文件存在并且是一个目录

​	案例1："ok"是否等于"ok"

![1565278253305](E:\Typora笔记\Pic\1565278253305.png)

​	案例2：23是否大于等于22

![1565278336512](E:\Typora笔记\Pic\1565278336512.png)

​	案例3：/root/shell/aaa.txt目录中的文件是否存在

​	![1565278495344](E:\Typora笔记\Pic\1565278495344.png)

​	![1565278508672](E:\Typora笔记\Pic\1565278508672.png)

​	流程控制

​		if  [ 条件判断式 ] 

​			then

​				程序

​			elif [ 条件判断式 ]

​			then

​				程序

​		fi

​	**条件判断式中中括号有空格**

​	案例：编写shell程序，如果输入得参数，大于等于60，输出及格，小于输出不及格

![1565279080418](E:\Typora笔记\Pic\1565279080418.png)



![1565279097465](E:\Typora笔记\Pic\1565279097465.png)

##### 9.shell语句的循环语句

​	基本语法

​		for 变量 in  值1值2值3值4值5.......

​			do

​				程序

​		done

​	案例1：打印命令行输入的参数   会使用到  $ *     $@

![1565279623952](E:\Typora笔记\Pic\1565279623952.png)

![1565279645409](E:\Typora笔记\Pic\1565279645409.png)



​				![1565279788844](E:\Typora笔记\Pic\1565279788844.png)

![1565279802115](E:\Typora笔记\Pic\1565279802115.png)

基本语法

​	for（（ 初始值；循环控制条件））

​	do 

​		程序

​	done

​	案例：从1加到100的值输出显示（这里可以看出$ * 和$ @的区别）

​	![1565280206449](E:\Typora笔记\Pic\1565280206449.png)

![1565280217145](E:\Typora笔记\Pic\1565280217145.png)

while 循环

​	while [   条件判断式  ]

​	do 	

​		程序

​	done

案例：输入一个数n   统计1+......+n的值

![1565280556113](E:\Typora笔记\Pic\1565280556113.png)

![1565280569122](E:\Typora笔记\Pic\1565280569122.png)

##### 10.read读取控制台输入

​	read [选项]  [参数]

​	-p	指定读取值时的提示符

​	-t     指定读取值时等待的时间

​	案例1：读取控制台输入的一个num值

​	案例2：读取控制台输入的一个num值，在10秒内输入	 

![1565281193491](E:\Typora笔记\Pic\1565281193491.png)

![1565281205682](E:\Typora笔记\Pic\1565281205682.png)

##### 11.shell函数

​	basename

​		返回完整路径最后   /  的部分，常用语获取文件名

​		basename  [pathname]  [suffix]

​	案例：请返回/home/aaa/test.txt 的test.txt部分

![1565281472259](E:\Typora笔记\Pic\1565281472259.png)



​	dirname

​		获取路径部分

​	案例：返回/home/aaa/test.txt路径

​		![1565281594345](E:\Typora笔记\Pic\1565281594345.png)

##### 12.自定义函数

​		[ function ] funname[()]

​	{

​			Action;

​			[return int;]	

​	}

案例：计算输入两个参数的和

​	![1565281979202](E:\Typora笔记\Pic\1565281979202.png)

​	![1565281991922](E:\Typora笔记\Pic\1565281991922.png)



