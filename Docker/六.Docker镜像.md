#### 六.Docker镜像

​	镜像是一种轻量级，可执行的独立软件包，用来打包软件运行环境和基于运行时环境开发的软件，他包含运行某个软件所需的所有内容，包括代码，运行时的库，环境变量和配置文件

![1571629267880](E:\Typora笔记\Pic\1571629267880.png)

##### 1.Docker的镜像加载原理

![1571667395854](E:\Typora笔记\Pic\1571667395854.png)

![1571667511740](E:\Typora笔记\Pic\1571667511740.png)

![1571667729829](E:\Typora笔记\Pic\1571667729829.png)

![1571667765950](E:\Typora笔记\Pic\1571667765950.png)

##### 2.Docker镜像commit操作补充

​	指令：

​		docker	commit	提交容器副本使之成为一个新的镜像

​		docker  commit -m="提交的描述信息"	-a "作者"	容器ID  要创造的目标镜像名：[标签名]

​	![1571668368237](E:\Typora笔记\Pic\1571668368237.png)

大P随机分配端口

![1571668463959](E:\Typora笔记\Pic\1571668463959.png)

提交修改后的镜像文件

![1571668729100](E:\Typora笔记\Pic\1571668729100.png)

会在本地镜像库，复制出一份修改后的镜像文件，可执行

![1571668966173](E:\Typora笔记\Pic\1571668966173.png)



![1571669144151](E:\Typora笔记\Pic\1571669144151.png)

##### 3.容器数据卷（重要）

​	![1571669314156](E:\Typora笔记\Pic\1571669314156.png)

![1571669388547](E:\Typora笔记\Pic\1571669388547.png)

![1571669509455](E:\Typora笔记\Pic\1571669509455.png)





容器中添加的两种方式：

###### （1）直接命令添加

​			docker	run	-it	-v	/宿主机绝对路径目录:/容器内目录		镜像名

​			![1571669990452](E:\Typora笔记\Pic\1571669990452.png)

​		![1571670050293](E:\Typora笔记\Pic\1571670050293.png)



​		主机建文件

![1571670096681](E:\Typora笔记\Pic\1571670096681.png)

​		容器中也有

![1571670115900](E:\Typora笔记\Pic\1571670115900.png)

​		当宿主机和容器添加了容器数据卷的时候，当容器停止，在宿主机的共享文件夹中更改数据，重新启动容器数据也会发生更改，类似以redis里面的rdb和aof



​	携带权限：

​			docker	run	-it	-v	/宿主机绝对路径目录:/容器内目录:ro		镜像名

​		![1571670578305](E:\Typora笔记\Pic\1571670578305.png)

![1571670636877](E:\Typora笔记\Pic\1571670636877.png)

​	宿主机对数据进行修改，容器可以接收，可以查看，但是不能修改

![1571670711962](E:\Typora笔记\Pic\1571670711962.png)

###### （2）DockerFile添加

![1571755558908](E:\Typora笔记\Pic\1571755558908.png)

​		写一个简单的dockerfile文件

![1571756108048](E:\Typora笔记\Pic\1571756108048.png)

![1571756310725](E:\Typora笔记\Pic\1571756310725.png)

![1571755841241](E:\Typora笔记\Pic\1571755841241.png)

![1571756479347](E:\Typora笔记\Pic\1571756479347.png)

![1571756512795](E:\Typora笔记\Pic\1571756512795.png)

运行自己新建的镜像文件，默认会和宿主机会产生联系进行数据交互，

![1571756566571](E:\Typora笔记\Pic\1571756566571.png)

![1571756629528](E:\Typora笔记\Pic\1571756629528.png)

会自动在宿主机的默认路径下建立联系

![1571756675327](E:\Typora笔记\Pic\1571756675327.png)



##### 4.数据卷容器

![1571757651242](E:\Typora笔记\Pic\1571757651242.png)

![但是](E:\Typora笔记\Pic\1571757695851.png)

运行自己新建的镜像文件

![1571757750232](E:\Typora笔记\Pic\1571757750232.png)

在数据卷中新建文件

![1571758370281](E:\Typora笔记\Pic\1571758370281.png)

退出容器（ctrl  +  p   +   q）  并继承于dc01 容器，启动新建的镜像文件

![1571758465455](E:\Typora笔记\Pic\1571758465455.png)

![1571758611581](E:\Typora笔记\Pic\1571758611581.png)

![1571758700282](E:\Typora笔记\Pic\1571758700282.png)

![1571758807001](E:\Typora笔记\Pic\1571758807001.png)

![1571758944651](E:\Typora笔记\Pic\1571758944651.png)

当删除了父容器的情况下，子容器的数据不会发生改变，当在其中一个子容器新建文件更改数据，也会在其他的容器中的数据卷发生数据改变，也就是说数据的传递并不受影响



